---
import { getCollection } from "astro:content";
import MainLayout from "../../layouts/main.astro";
import BlogSection from "../../components/BlogSection";

const allPosts = (await getCollection("blog"))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

const base = import.meta.env.BASE_URL;
---

<MainLayout title="Blog | Said Azizov">
  <div class="min-h-screen bg-[#0e0e0e] text-[#e8e0d8]">
    {/* Nav */}
    <nav class="sticky top-0 z-50 bg-[#0e0e0e]/80 backdrop-blur-md border-b border-white/5">
      <div class="max-w-6xl mx-auto px-6 py-4">
        <a
          href={base}
          class="text-stone-400 hover:text-stone-200 transition-colors text-sm font-sans uppercase tracking-[0.15em]"
        >
          &larr; Home
        </a>
      </div>
    </nav>

    {/* Content */}
    <div class="py-24">
      <BlogSection
        posts={allPosts.map((b) => ({
          id: b.id,
          title: b.data.title,
          date: b.data.date.toISOString(),
          category: b.data.category,
          description: b.data.description,
          coverImage: b.data.coverImage,
          result: b.data.result,
          emoji: b.data.emoji,
          tags: b.data.tags,
          link: b.data.link,
        }))}
        basePath={base}
        showViewAll={false}
        client:load
      />
    </div>
  </div>
</MainLayout>
